<mat-card class="chart-card">
  <mat-card-header>
    <mat-card-title>
      <mat-icon>wb_sunny</mat-icon>
      Solar Production - Last 7 Days
    </mat-card-title>
  </mat-card-header>

  <mat-card-content>
    @if (isLoading) {
      <div class="loading-state">
        <p>Loading chart data...</p>
      </div>
    }

    @if (hasError && !isLoading) {
      <div class="error-state">
        <mat-icon>error_outline</mat-icon>
        <p>{{ errorMessage }}</p>
      </div>
    }

    @if (!isLoading && !hasError && chartData.length === 0) {
      <div class="empty-state">
        <mat-icon>info_outline</mat-icon>
        <p>No production data available for the last 7 days</p>
      </div>
    }

    @if (!isLoading && !hasError && chartData.length > 0) {
      <div class="chart-container">
        <!-- Y-axis -->
        <div class="y-axis">
          @for (label of yAxisLabels; track label) {
            <div class="y-axis-label">
              {{ formatYAxisLabel(label) }}
            </div>
          }
        </div>
        <!-- Chart area -->
        <div class="chart-area">
          <!-- Grid lines -->
          <div class="grid-lines">
            @for (label of yAxisLabels; track label) {
              <div class="grid-line"></div>
            }
          </div>
          <!-- Bars -->
          <div class="bars-container">
            @for (bar of chartData; track bar) {
              <div class="bar-wrapper">
                <div
                  class="bar"
                  [style.height.%]="bar.heightPercent"
                  [title]="bar.displayValue"
                  >
                  <div class="bar-tooltip">{{ bar.displayValue }}</div>
                </div>
                <div class="x-axis-label">{{ bar.displayDate }}</div>
              </div>
            }
          </div>
        </div>
      </div>
    }

    @if (!isLoading && !hasError && chartData.length > 0) {
      <div class="chart-info">
        <small>Energy units in Watt-hours (Wh)</small>
      </div>
    }
  </mat-card-content>
</mat-card>
